<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Introducing the grammar :: FHIRconnect</title>
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">FHIRconnect</a>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="FHIRconnect" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">FHIRconnect</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Grammar</span>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="file-structure.html">Grammar</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mapping-body.html">Mapping body</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Engine</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="engine.html">Engine</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">FHIRconnect</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="index.html">FHIRconnect</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">FHIRconnect</a></li>
    <li>Grammar</li>
    <li><a href="file-structure.html">Grammar</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="file:///home/severin/repos/FHIRconnect/modules/ROOT/pages/file-structure.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Introducing the grammar</h1>
<div class="sect1">
<h2 id="_file_structure"><a class="anchor" href="#_file_structure"></a>File structure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mappings are organized in three type of files. The <strong>model mapping</strong>,
which is the vanilla mapping describing the transformation between an
archetype and a un-profiled resource. This is the most basic form of
mapping that is to be shared and maintained by the communities.</p>
</div>
<div class="paragraph">
<p><strong>Extension mappings</strong> are used to extend model mappings by adding,
overwriting or appending mapping logic to the vanilla model mappings.
This is required to map between templates and profiles. The model
mappings act like a sustainable set of base mappings that can be
extended for a given scope using extension mappings. Extension mappings
act similar to a String Builder.</p>
</div>
<div class="paragraph">
<p><strong>Context mappings</strong> define the import of model mappings and extension
mappings, what profile is transformed to which template and with what
mapping file to start. There is one context file required for each
profile and template mapped. From a developer perspective they act as an
import and main.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/FileStructure.drawio.png" alt="FileStructure.drawio">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_header"><a class="anchor" href="#_the_header"></a>The header</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The header is contained in each FHIRconnect mapping file. It is
standardized for both FHIRconnect and
<a href="https://github.com/SevKohler/OMOCL">OMOCL</a>.</p>
</div>
<div class="paragraph">
<p>An example of a model mapping header:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">engine: FHIRConnect/v0.0.1  # what grammar and version is used in this file
type: model  # the type of mapping: model, extension or context
metadata:
  name: ACTION.informed_consent.v0  #the name of the mapping
  version: 0.0.1a # version of this particular mapping
spec: # schema specific to the FHIRConnect v0.0.1 engine
  system: FHIR  # What is mapped
  version: R4
  openEhrConfig:
    archetype: ACTION.informed_consent.v0 # what openEHR archetype is mapped in this model mapping
  fhirConfig:
    structureDefinition: http://hl7.org/fhir/StructureDefinition/Consent # to what FHIR structureDefinition this is mapped</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example of a extension mapping header:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">engine: FHIRConnect/v0.0.1
type: extension
metadata:
  name:  KDS_anatomical_location
  version: 0.0.1a # version of this particular mapping
spec: # schema specific to the FHIRConnect v0.0.1 engine
  system: FHIR
  version: R4
  extends: CLUSTER.anatomical_location.v1 # the name of the model mapping that is to be extended</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example of a context mapping header:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">engine: FHIRConnect/v0.0.1
type: context
metadata:
  name:  KDS_diagnose.context
  version: 0.0.1a
spec:
  system: FHIR
  version: R4</code></pre>
</div>
</div>
<div class="paragraph">
<p>Naming conventions are here the following: Names of model mappings
always start with the type of openEHR class (e.g. EVALUATION) and the
full name and version. Sometimes it happens that two resources can be
transformed into one archetype, in this case the name of the mapping is
to be extended with what fhir type to what openEHR archetype</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CLUSTER.medication.v2 (this maps medication-to-medication)</p>
</li>
<li>
<p>CLUSTER.medication.v2.substance-to-medication (this does not map a
FHIR medication but an FHIR substance)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This allows to separately call this archetype mappings for different use
cases. The initial one created always stays as <code>CLUSTER.medication.v2</code>
and is to be seen as the default. All future mappings created that also
map to medication but from another FHIR input have to add a string to
their name as described above. We deem the first mapping as the default
one, furthermore we want to prevent dependency problems by renaming the
file later on. For extension and context mapping names, there is no
specific style guide since this is a project specific decision users
have to take.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
